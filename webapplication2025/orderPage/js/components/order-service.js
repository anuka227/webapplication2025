class OrderService extends HTMLElement {
    constructor() {
        super();
        this.servicesData = null;
    }

    async connectedCallback() {
        await this.loadServicesData();
        this.render();
        this.setupEventListeners();
    }

    async loadServicesData() {
        try {
            const response = await fetch('http://localhost:3000/api/salons');
            const data = await response.json();
            
            const servicesMap = new Map();
            
            data.salons.forEach(salon => {
                if (salon.id === 'independent') return;
                
                if (salon.service && Array.isArray(salon.service)) {
                    salon.service.forEach(serviceGroup => {
                        const serviceType = serviceGroup.type; 
                        
                        if (!servicesMap.has(serviceType)) {
                            servicesMap.set(serviceType, new Set());
                        }
                        
                        if (serviceGroup.subservice && Array.isArray(serviceGroup.subservice)) {
                            serviceGroup.subservice.forEach(sub => {
                                servicesMap.get(serviceType).add(sub.id);
                            });
                        }
                    });
                }
            });
            
            // ✅ Бие даасан артистуудаас service цуглуулах
            const independentSalon = data.salons.find(s => s.id === 'independent');
            if (independentSalon && independentSalon.artists) {
                independentSalon.artists.forEach(artist => {
                    if (artist.service && Array.isArray(artist.service)) {
                        artist.service.forEach(serviceGroup => {
                            const serviceType = serviceGroup.type;
                            
                            if (!servicesMap.has(serviceType)) {
                                servicesMap.set(serviceType, new Set());
                            }
                            
                            if (serviceGroup.subservice && Array.isArray(serviceGroup.subservice)) {
                                serviceGroup.subservice.forEach(sub => {
                                    servicesMap.get(serviceType).add(sub.id);
                                });
                            }
                        });
                    }
                });
            }
            
            this.servicesData = {};
            servicesMap.forEach((subserviceSet, serviceType) => {
                this.servicesData[serviceType] = Array.from(subserviceSet);
            });
            
            console.log('Services loaded:', this.servicesData);
            
        } catch (error) {
            console.error('JSON ачаалах алдаа:', error);
        }
    }

    getSVGIcon(serviceType) {
        const icons = {
            'Үс': `<svg width="25px" height="25px" fill="currentColor" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="64px" height="64px" viewBox="0 0 30 29.893" xml:space="preserve" stroke="currentColor">
<g id="SVGRepo_bgCarrier" stroke-width="0"/>
<g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"/>
<g id="SVGRepo_iconCarrier"> <g id="hair-dryer"> <g> <path d="M29.807,27.973l0.004-0.005c-2.826-2.949-5.441-1.813-7.752-0.807c-1.651,0.721-3.213,1.402-4.92,0.749 c-0.871-0.33-1.423-0.809-1.645-1.419c-0.184-0.502-0.135-1.045-0.028-1.488l1.228,0.22c0.619,0.109,1.218-0.307,1.326-0.925 l1.508-8.447c3.688-0.714,6.474-3.955,6.474-7.851c0-4.419-3.582-8-8-8c-2.524,0-4.772,1.173-6.239,3H4v9h7.079 c0.565,0.977,1.34,1.813,2.25,2.474l-1.556,8.71c-0.11,0.618,0.306,1.216,0.925,1.326l1.081,0.191 c-0.15,0.686-0.201,1.527,0.099,2.362c0.394,1.104,1.287,1.931,2.647,2.451c2.365,0.899,4.412,0.006,6.218-0.78 c2.225-0.971,3.829-1.669,5.831,0.419l0.006-0.007c0.15,0.136,0.35,0.218,0.566,0.218c0.473,0,0.854-0.382,0.854-0.852 C30,28.309,29.928,28.121,29.807,27.973z M18,4c2.206,0,4,1.794,4,4c0,2.205-1.794,4-4,4s-4-1.795-4-4C14,5.794,15.794,4,18,4z"/> <circle cx="18" cy="8" r="2"/> <path d="M0,4.001v6.997C0,11.552,0.448,12,1.001,12H3V3H1.001C0.448,3,0,3.448,0,4.001z"/> </g> </g> <g id="Layer_1_1_"> </g> </g>
</svg>`,
            'Хумс': `<svg fill="currentColor" height="25px" width="25px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 511.063 511.063" xml:space="preserve">
								<g>
									<g>
										<g>
											<path d="M404.625,221.279c-4.378-40.286-16.375-82.577-47.343-128.708c3.371-6.613,3.132-14.507-1.084-21.129
												c-5.393-8.457-15.394-12.015-25.481-8.644c-2.227,0.725-3.806-0.418-4.378-0.939c-0.572-0.529-1.86-2.005-1.323-4.233l0.23-0.956
												c1.664-7.39-0.734-14.925-6.409-20.139c-5.854-5.402-14.174-7.253-21.709-4.898l-78.976,43.759L119.731,5.275
												c-9.182-5.367-19.874-6.682-30.08-3.746C79.437,4.481,71.108,11.3,66.201,20.72c-4.907,9.438-5.717,20.164-2.278,30.225
												c3.447,10.061,10.658,18.039,20.233,22.443l108.015,51.183l9.173,88.695l0.35,1.69c1.724,5.47,5.564,9.95,10.496,12.664
												c-22.75,19.081-36.019,47.095-36.019,77.201v112.375c0,51.755,42.112,93.867,93.867,93.867h85.333
												c51.755,0,93.867-42.112,93.867-93.867V304.821C449.237,271.131,432.555,240.138,404.625,221.279z M208.913,120.586
												l12.672-24.337l2.389-4.574l78.925-43.913c1.818-0.307,3.422,0.435,4.386,1.323c0.819,0.759,1.715,2.039,1.152,4.523
												c-1.843,7.697,0.538,15.488,6.374,20.838c5.837,5.342,13.815,7.049,21.871,4.352c2.961-0.99,4.565,0.947,5.12,1.818
												c0.555,0.87,1.621,3.149-0.922,5.82c-0.051,0.06-0.085,0.137-0.137,0.196c-0.009,0.008-0.026,0.008-0.034,0.026
												c-0.273,0.29-0.427,0.649-0.683,0.956c-0.981,1.186-1.929,2.381-2.62,3.703c-0.145,0.282-0.196,0.589-0.324,0.87
												c-0.674,1.417-1.271,2.867-1.604,4.386c-0.068,0.316-0.034,0.649-0.094,0.964c-0.256,1.519-0.461,3.038-0.384,4.599
												c0.026,0.521,0.213,1.041,0.282,1.562c0.162,1.331,0.282,2.662,0.7,3.985c0.009,0.034,0.034,0.06,0.051,0.102
												c0,0.017,0,0.034,0.009,0.051c0.239,0.759,0.683,1.391,0.998,2.108c0.461,1.033,0.845,2.108,1.442,3.038
												c0.521,0.794,1.229,1.434,1.843,2.142c0.614,0.717,1.135,1.51,1.852,2.133c0.947,0.828,2.082,1.459,3.191,2.125
												c0.546,0.333,1.007,0.768,1.596,1.058c1.766,0.862,3.695,1.519,5.76,1.937c3.055,0.623,3.49,3.098,3.533,4.147
												c0.051,1.033-0.171,3.533-3.703,4.582c-7.586,2.253-13.133,8.218-14.848,15.94c-0.435,1.929-0.597,3.866-0.503,5.76
												c0.282,5.709,2.884,11.128,7.654,15.352c1.681,1.502,1.681,3.132,1.374,4.275c-0.111,0.435-0.256,0.819-0.393,1.067
												c-0.469,0.922-1.946,2.987-5.495,2.125c-7.689-1.826-15.488,0.546-20.838,6.374c-5.35,5.837-7.049,13.807-4.361,21.879
												c0.981,2.953-0.947,4.557-1.818,5.12c-0.87,0.546-3.14,1.613-5.828-0.93c-1.434-1.357-3.004-2.492-4.676-3.396
												c-0.495-0.265-1.041-0.367-1.545-0.589c-3.499-1.544-7.287-2.091-11.145-1.604c-1.297,0.171-2.594,0.282-3.874,0.691
												c-5.393,1.698-9.643,5.333-12.288,10.274c-0.137,0.247-0.333,0.427-0.461,0.683c-0.87,1.775-1.527,3.712-1.954,5.794
												c-0.623,3.046-3.098,3.49-4.13,3.533c-1.05,0.094-3.541-0.179-4.591-3.721c-2.253-7.578-8.218-13.141-15.94-14.848h-0.043
												c-1.587-0.35-3.174-0.521-4.736-0.521c-0.196,0-0.384,0.051-0.589,0.06c-0.478,0.017-0.939,0.102-1.417,0.145
												c-1.323,0.128-2.611,0.367-3.874,0.734c-0.435,0.128-0.862,0.265-1.297,0.427c-1.451,0.529-2.833,1.212-4.156,2.057
												c-0.171,0.111-0.35,0.188-0.529,0.307c-1.468,1.007-2.867,2.142-4.096,3.533l-0.316,0.358l-0.811,0.606
												c-0.094,0.077-0.145,0.188-0.23,0.265c-1.041,0.614-2.15,0.606-2.995,0.41c-1.28-0.29-2.825-1.169-3.601-2.825L208.913,120.586z
												M432.171,417.196c0,42.351-34.458,76.8-76.8,76.8h-85.333c-42.342,0-76.8-34.449-76.8-76.8V304.821
												c0-23.031,9.344-44.604,25.6-60.254v16.631c-0.341,14.097-0.23,27.921-0.111,41.506c0.06,6.579,0.111,13.073,0.111,19.482v7.927
												c0,43.315,35.234,78.549,78.558,78.549h30.618c43.324,0,78.558-35.234,78.558-78.549v-7.927c0-7.927,0.111-15.906,0.23-23.927
												c0.23-16.606,0.461-33.357-0.23-50.398v-3.294c16.256,15.65,25.6,37.222,25.6,60.254V417.196z"/>
											<path d="M280.158,183.222c1.664,2.33,4.292,3.575,6.955,3.575c1.715,0,3.448-0.521,4.949-1.596
												c3.84-2.731,4.727-8.064,1.988-11.896l-33.033-46.242h60.22c4.71,0,8.533-3.814,8.533-8.533s-3.823-8.533-8.533-8.533h-76.8
												c-3.2,0-6.127,1.783-7.586,4.625c-1.468,2.85-1.212,6.263,0.64,8.866L280.158,183.222z"/>
										</g>
									</g>
								</g>
							</svg>`,
            'Гоо сайхан': `<svg fill="currentColor" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	 							width="25px" height="25px" viewBox="0 0 172.687 172.687"
	 							xml:space="preserve">
							<g>
								<g>
									<path d="M84.866,140.97c-1.144,0-4.305-1.68-7.554-1.68c-5.721,0-12.254,1.686-12.254,1.68c0,0,4.891,2.923,12.13,3.256
										c2.309,0.104,5.021-0.607,7.671-0.607c3.218,0,6.26,0.514,8.947,0.363c6.453-0.353,10.856-3.012,10.856-3.012
										s-5.417-1.438-10.501-1.438C90.066,139.531,86.276,140.97,84.866,140.97z"/>
									<path d="M84.866,129.243c-12.361,0-22.415,11.727-22.415,11.727s10.053,14.162,22.415,14.162
											c12.365,0,22.412-14.162,22.412-14.162S97.231,129.243,84.866,129.243z M84.866,151.262c-12.368,0-19.804-10.292-19.804-10.292
											s10.972-7.77,13.58-7.584c2.604,0.186,6.225,2.949,6.225,2.949s4.549-2.949,7.714-2.949s12.088,7.584,12.088,7.584
											S97.231,151.262,84.866,151.262z"/>
										<path d="M78.058,103.99c0-7.814-6.356-14.161-14.162-14.161c-7.816,0-14.159,6.347-14.159,14.161
											c0,7.808,6.348,14.156,14.159,14.156C71.702,118.146,78.058,111.798,78.058,103.99z M69.019,100.226
											c3.549,1.707,4.468,5.526,4.683,7.037c0.219,1.51-2.996,0.562-3.103-0.4c-0.073-0.673,0.178-1.713-1.475-3.267l-0.048,0.969
											c-1.267,2.194-4.08,2.95-6.266,1.681c-2.192-1.265-2.941-4.051-1.697-6.238c-3.397-0.536-7.039-0.607-7.039-0.607
											S64.255,97.916,69.019,100.226z M55.409,105.369c0,0,3.221,1.488,6.058,2.08c2.554,0.524,8.909,0.814,8.909,0.814
											s-5.436,0.788-8.315,0.788C59.181,109.047,55.409,105.369,55.409,105.369z"/>
										<path d="M156.165,75.221c0.065-1.239,0.199-2.46,0.199-3.721c0-39.426-32.077-71.5-71.498-71.5C45.445,0,13.368,32.08,13.368,71.5
											c0,21.088,9.224,40.014,23.796,53.108c9.319,27.838,35.565,48.078,47.702,48.078c12.136,0,38.38-20.24,47.704-48.078
											c5.767-5.188,10.659-11.327,14.512-18.123c0.887-0.668,1.644-1.429,2.145-2.32l1.686-2.934l-0.87-0.448l0.011-0.027l1.932-1.116
											c4.192-2.413,6.677-8.77,7.214-13.663C159.702,81.372,158.605,77.58,156.165,75.221z M149.435,69.448l0.033,0.375l-0.252-0.391
											L149.435,69.448z M84.866,6.81c30.784,0,56.558,21.634,63.042,50.491c-3.146-4.685-8.323-8.215-13.319-8.215l-1.384,0.156
											c-26.277-24.476-64.7-29.735-93.145-24.285C51.694,13.746,67.473,6.81,84.866,6.81z M106.918,106.245
											c-2.189,1.27-5,0.514-6.261-1.681l-0.055-0.969c-1.653,1.554-1.401,2.594-1.472,3.267c-0.104,0.958-3.321,1.904-3.101,0.4
											c0.219-1.511,1.136-5.33,4.682-7.037c4.761-2.31,14.938-0.826,14.938-0.826s-3.633,0.076-7.037,0.607
											C109.861,102.194,109.108,104.985,106.918,106.245z M114.323,105.369c0,0-3.772,3.678-6.648,3.678c-2.892,0-8.32-0.789-8.32-0.789
											s6.359-0.284,8.909-0.82C111.098,106.857,114.323,105.369,114.323,105.369z M121.584,48.414c-3.493,0.695-6.699,2.465-9.179,5.453
											c-0.562,0.684-0.979,1.488-1.461,2.246c-7.639-4.011-16.535-5.995-26.078-5.995c-8.967,0-17.393,1.718-24.712,5.256
											c0.496-0.495,0.946-1.021,1.458-1.502c11.689-11.004,26.701-16.58,42.309-15.677C110.118,40.859,116.047,44.296,121.584,48.414z
											 M34.217,111.629c-8.764-11.042-14.042-24.975-14.042-40.124c0-14.082,4.573-27.081,12.238-37.71
											c15.331-4.684,35.457-5.727,55.054-1.037c-11.248,2.432-21.742,7.888-30.522,16.16c-8.523,8.024-14.703,18.06-17.703,28.016
											c-3.456,7.538-5.452,16.692-5.452,27.658C33.791,106.966,33.942,109.319,34.217,111.629z M84.866,168.177
											c-17.36,0-46.229-35.262-46.229-65.096c0-25.945,20.693-46.974,46.229-46.974c8.524,0,16.491,2.39,23.35,6.478
											c-0.686,2.942-0.816,6.035-0.257,9.006l0.58,2.851l-0.462,0.936c-1.948,4.73-1.696,10.025,0.493,14.731
											c-0.882-0.171-1.796-0.274-2.73-0.274c-7.807,0-14.162,6.349-14.162,14.156c0,7.813,6.355,14.161,14.162,14.161
											c7.82,0,14.156-6.348,14.156-14.161c0-1.769-0.354-3.441-0.952-5.007l3.917,0.771c0.121,1.078,0.374,2.092,0.799,3.021
											c1.298,2.802,3.997,4.53,7.037,5.488C127.799,136.844,101.231,168.177,84.866,168.177z M121.889,94.283
											c-0.053-0.592,0.761-1.691,2.146-2.993c-0.505,1.724-0.899,3.502-1.063,5.226L121.889,94.283z M135.514,111.629
											c0.101-0.804,0.088-1.63,0.143-2.446c0.515,0.033,1.028,0.061,1.523,0.061C136.608,110.031,136.115,110.863,135.514,111.629z
											 M150.365,96.849c-6.127-11.867-14.783-14.093-14.783-14.093s3.335,15.976,10.843,19.812c-2.788,4.87-17.039,4.695-19.732-1.149
											c-2.689-5.845,4.608-18.968,4.608-18.968s-15.003,7.686-12.317,13.229c-5.784-1.134-11.491-10.37-7.924-19.082
											c2.621-6.397,17.444,0.721,17.444,0.721s-14.058-12.184-17.373-6.329c-1.915-10.151,5.237-21.891,16.202-19.475
											c-8.682,7.984,4.183,22.72,4.183,22.72s-4.79-16.068-1.243-20.042c5.264-5.907,17.313,3.161,17.384,11.872
											c-6.167-0.465-12,11.825-12,11.825s13.444-4.774,18.191-0.459C158.573,81.766,155.029,94.162,150.365,96.849z M145.149,94.49
											c-0.229,0.602-0.442,1.204-0.694,1.796c-1.28-1.861-2.435-4.132-3.371-6.513C142.399,90.967,143.787,92.542,145.149,94.49z
											 M143.245,72.783l-0.607,0.05l0.384-0.429L143.245,72.783z"/>
									</g>
								</g>
							</svg>`,
            'Вакс': `<svg fill="currentColor" height="25px" width="25px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
								 viewBox="0 0 496 496" xml:space="preserve">
							<g>
								<g>
									<g>
										<path d="M496,16V0H296c-22.056,0-40,17.944-40,40c0,22.056,17.944,40,40,40c8.816,0,16,7.184,16,16v30.312
											c0,4.76-1.392,9.36-4.032,13.312l-5.248,7.872c-4.4,6.592-6.72,14.264-6.72,22.192V176c0,22.056,17.944,40,40,40
											c22.056,0,40-17.944,40-40v-6.312c0-7.928-2.32-15.6-6.72-22.184l-5.248-7.872c-2.64-3.96-4.032-8.56-4.032-13.32V96
											c0-8.816,7.176-16,16-16h120V64H392v-8c0-13.232-10.768-24-24-24c-4.416,0-8-3.584-8-8v-8H496z M360,176
											c0,13.232-10.768,24-24,24s-24-10.768-24-24v-6.312c0-4.76,1.392-9.36,4.032-13.312l5.248-7.872
											c4.4-6.592,6.72-14.264,6.72-22.192V96c0-5.856-1.696-11.272-4.448-16h24.896C345.696,84.728,344,90.144,344,96v30.312
											c0,7.928,2.32,15.6,6.72,22.192l5.248,7.872c2.64,3.952,4.032,8.552,4.032,13.312V176z M368,48c4.416,0,8,3.584,8,8v8h-80
											c-13.232,0-24-10.768-24-24s10.768-24,24-24h48v8C344,37.232,354.768,48,368,48z"/>
										<path d="M264,160c0-22.056-17.944-40-40-40H40c-22.056,0-40,17.944-40,40v336h136h8h296v-32.552c31.52-3.96,56-30.872,56-63.448
											v-96H264V160z M16,160c0-13.232,10.768-24,24-24h184c13.232,0,24,10.768,24,24v24H16V160z M16,200h232v16H16V200z M16,232h232v72
											h-36.904c-11.76-33.256-43.424-56-79.096-56c-46.32,0-84,37.68-84,84c0,25.624,11.952,49.8,32,65.696V400
											c0,11.664,3.184,22.576,8.656,32H16V232z M193.872,304H80v71.632C69.816,363.504,64,348.096,64,332c0-37.496,30.504-68,68-68
											C158.92,264,183.024,280.008,193.872,304z M136,480H16v-32h85.808c9.384,8.256,21.168,13.808,34.192,15.448V480z M424,480H152
											v-16h272V480z M480,320v16h-16v16h16v48c0,26.472-21.528,48-48,48H144c-26.472,0-48-21.528-48-48v-48h352v-16H96v-16H480z"/>
									</g>
								</g>
							</g>
							</svg>`,
            'Хөмсөг': `<svg width="25px" height="25px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    							<title>eyebrow_fill</title>
    								<g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        								<g id="Part" transform="translate(-192.000000, -48.000000)" fill-rule="nonzero">
            							<g id="eyebrow_fill" transform="translate(192.000000, 48.000000)">
                					<path d="M24,0 L24,24 L0,24 L0,0 L24,0 Z M12.5934901,23.257841 L12.5819402,23.2595131 L12.5108777,23.2950439 L12.4918791,23.2987469 L12.4918791,23.2987469 L12.4767152,23.2950439 L12.4056548,23.2595131 C12.3958229,23.2563662 12.3870493,23.2590235 12.3821421,23.2649074 L12.3780323,23.275831 L12.360941,23.7031097 L12.3658947,23.7234994 L12.3769048,23.7357139 L12.4804777,23.8096931 L12.4953491,23.8136134 L12.4953491,23.8136134 L12.5071152,23.8096931 L12.6106902,23.7357139 L12.6232938,23.7196733 L12.6232938,23.7196733 L12.6266527,23.7031097 L12.609561,23.275831 C12.6075724,23.2657013 12.6010112,23.2592993 12.5934901,23.257841 L12.5934901,23.257841 Z M12.8583906,23.1452862 L12.8445485,23.1473072 L12.6598443,23.2396597 L12.6498822,23.2499052 L12.6498822,23.2499052 L12.6471943,23.2611114 L12.6650943,23.6906389 L12.6699349,23.7034178 L12.6699349,23.7034178 L12.678386,23.7104931 L12.8793402,23.8032389 C12.8914285,23.8068999 12.9022333,23.8029875 12.9078286,23.7952264 L12.9118235,23.7811639 L12.8776777,23.1665331 C12.8752882,23.1545897 12.8674102,23.1470016 12.8583906,23.1452862 L12.8583906,23.1452862 Z M12.1430473,23.1473072 C12.1332178,23.1423925 12.1221763,23.1452606 12.1156365,23.1525954 L12.1099173,23.1665331 L12.0757714,23.7811639 C12.0751323,23.7926639 12.0828099,23.8018602 12.0926481,23.8045676 L12.108256,23.8032389 L12.3092106,23.7104931 L12.3186497,23.7024347 L12.3186497,23.7024347 L12.3225043,23.6906389 L12.340401,23.2611114 L12.337245,23.2485176 L12.337245,23.2485176 L12.3277531,23.2396597 L12.1430473,23.1473072 Z" id="MingCute" fill-rule="nonzero">
									</path>
                					<path d="M18.9372,9.36167 C20.6395,10.1301 22.108,11.2831 22.8998,12.9158 C23.0681,13.2628 23.0219,13.6757 22.781,13.9769 C22.5401,14.278 22.1474,14.4138 21.772,14.3258 C15.8145,12.93 9.78907,15.3311 6.61118,16.6414 C4.618,17.4633 2.68113,16.7923 1.68066,15.44 C1.18289,14.7672 0.915929,13.9186 1.02369,13.0307 C1.36416,10.2254 4.88953,9.02468 7.21626,8.49728 C10.9972,7.64025 15.3643,7.74879 18.9372,9.36167 Z" id="路径" fill="currentColor">
									</path>
            						</g>
        						</g>
    						</g>
							</svg>`,
            'Сормуус': `<svg height="25px" width="25px" version="1.1" id="_x32_" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	 								viewBox="0 0 512 512"  xml:space="preserve">
							<style type="text/css">
									.st0{fill: currentColor;}
							</style>
							<g>
								<path class="st0" d="M404.946,230.669C428.2,245.234,463.907,261.977,512,268.662c-32.248-25.252-53.918-48.832-67.492-66.023
									c14.297-12.091,27.43-25.52,39.049-40.207l-37.515-29.708c-21.308,26.916-48.434,49.013-79.43,64.366
									c-31.011,15.346-65.853,23.971-102.884,23.985c-37.027-0.014-71.872-8.639-102.883-23.985c-31-15.353-58.129-37.45-79.43-64.366
									l-37.522,29.708c9.073,11.461,19.068,22.154,29.791,32.067C60.933,211.915,37.696,239.141,0,268.662
									c53.55-7.446,91.748-27.35,114.486-42.848c8.111,5.122,16.475,9.884,25.121,14.159c1.249,0.615,2.515,1.208,3.774,1.802
									c-3.662,21.749-12.658,60.502-33.55,94.696c40.634-18.03,69.264-54.359,83.775-76.427c10.882,2.807,22.017,4.971,33.362,6.461
									l29.028,112.77l28.623-111.15c12.177-0.897,24.155-2.554,35.866-4.963c15.075,22.242,42.917,56.103,81.691,73.308
									c-18.993-31.083-28.153-65.928-32.414-88.351c6.135-2.51,12.184-5.217,18.096-8.147
									C393.68,237.087,399.352,233.932,404.946,230.669z"/>
							</g>
							</svg>`,
            'Нүүр будалт': `<svg fill="currentColor" height="25px" width="25px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
								 viewBox="0 0 219.992 219.992" xml:space="preserve">
							<path d="M147.206,102.657l-33.167,30.359l-27.075-27.075l30.359-33.167L147.206,102.657z M81.557,111.848L3.435,197.195
								c-4.793,5.416-4.541,13.664,0.572,18.777c2.589,2.589,6.031,4.015,9.694,4.015c3.349,0,6.574-1.223,9.133-3.487l85.297-78.077
								L81.557,111.848z M211.809,50.894L169.085,8.17c-5.266-5.265-11.898-8.165-18.678-8.165c-9.933,0-17.749,6.389-19.449,15.897
								l-8.979,50.214l31.884,31.884l50.214-8.979c7.306-1.306,12.746-6.039,14.927-12.985C221.649,67.612,218.892,57.978,211.809,50.894z"
								/>
							</svg>`,
            'Spa': `<svg fill="currentColor" height="25px" width="25px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
					viewBox="0 0 511.999 511.999" xml:space="preserve"><g><g>
						<path d="M511.505,390.084c-1.954-6.81-9.071-10.624-15.821-8.798l-83.908,23.979L339.9,357.35c-2.099-1.399-4.574-2.15-7.1-2.15
						H38.4c-7.074,0-12.8,5.726-12.8,12.8c0,7.074,5.726,12.8,12.8,12.8h290.517l73.574,49.05c2.125,1.417,4.599,2.15,7.1,2.15
						c1.178,0,2.364-0.162,3.516-0.486l89.6-25.6C509.508,403.959,513.442,396.876,511.505,390.084z"/></g></g>
						<g><g>
						<path d="M422.391,252.799c-35.285,0-64,28.706-64,64c0,35.285,28.715,64,64,64c35.294,0,64-28.715,64-64
						C486.391,281.506,457.685,252.799,422.391,252.799z M422.391,355.199c-21.205,0-38.4-17.195-38.4-38.4
						c0-21.205,17.195-38.4,38.4-38.4c21.205,0,38.4,17.195,38.4,38.4C460.792,338.005,443.597,355.199,422.391,355.199z"/></g></g><g><g>
						<path d="M217.6,79.999c-35.285,0-64,28.706-64,64s28.706,64,64,64c35.294,0,64-28.715,64-64
						C281.6,108.706,252.894,79.999,217.6,79.999z M217.6,182.399c-21.205,0-38.4-17.195-38.4-38.4s17.186-38.4,38.4-38.4
						c21.205,0,38.4,17.195,38.4,38.4S238.805,182.399,217.6,182.399z"/></g></g>
<g>
	<g>
		<path d="M288.179,280.226l-128-76.8c-3.063-1.826-6.758-2.347-10.163-1.314c-3.422,0.998-6.272,3.379-7.876,6.562l-51.2,102.4
			c-3.157,6.323-0.589,14.012,5.734,17.178c1.835,0.913,3.789,1.348,5.709,1.348c4.702,0,9.216-2.586,11.46-7.074l45.013-90.035
			l116.147,69.683c6.076,3.635,13.926,1.673,17.562-4.386S294.238,283.861,288.179,280.226z"/>
	</g>
</g>
<g>
	<g>
		<path d="M332.8,406.399h-320c-7.074,0-12.8,5.726-12.8,12.8c0,7.074,5.726,12.8,12.8,12.8h320c7.074,0,12.8-5.726,12.8-12.8
			C345.6,412.125,339.874,406.399,332.8,406.399z"/>
	</g>
</g>
</svg>`,
			'Шивээс': `<svg fill="currentColor" height="25px" width="25px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 459.82 459.82" xml:space="preserve" stroke="currentColor">
						<g id="SVGRepo_bgCarrier" stroke-width="0"/>
						<g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"/>
						<g id="SVGRepo_iconCarrier"> <path d="M458.648,213.641l-53.128-53.128c1.471-4.246,4.284-13.429,5.426-24.395c1.9-18.255-1.774-33.442-10.608-44.271 c0.864-1.96,1.329-4.05,1.397-6.155l12.564-3.165l1.051,6.227c0.33,1.953,2.023,3.335,3.939,3.335c0.221,0,0.445-0.019,0.67-0.057 l28.453-4.803c2.179-0.368,3.646-2.432,3.279-4.61l-3.325-19.699c-0.177-1.046-0.762-1.979-1.626-2.594 c-0.865-0.614-1.939-0.859-2.984-0.685l-28.454,4.803c-1.046,0.177-1.979,0.762-2.594,1.626s-0.861,1.938-0.685,2.984l0.938,5.558 l-12.899,3.249c-1.347-2.756-3.458-5.229-6.49-7.004c-5.664-3.316-12.913-2.987-18.188,0.918c-4.711,3.488-6.936,8.79-6.735,14.015 l-9.028,2.275l1.955,7.758l9.301-2.344c0.703,1.21,1.554,2.356,2.589,3.392c1.378,1.378,2.946,2.443,4.613,3.234 c2.981,6.526-0.104,19.573-3.721,29.245l-53.308-53.308c-0.75-0.75-1.768-1.172-2.829-1.172s-2.078,0.422-2.829,1.172 L194.227,197.21l-15.745-15.745c-0.75-0.75-1.768-1.172-2.829-1.172s-2.078,0.422-2.829,1.172l-4.496,4.496l-4.283-4.284 l13.39-13.39c1.562-1.562,1.562-4.094,0-5.656l-12.818-12.818c-1.562-1.562-4.095-1.562-5.657,0l-32.438,32.438 c-1.562,1.562-1.562,4.095,0,5.656l12.818,12.818c0.781,0.781,1.805,1.172,2.829,1.172s2.047-0.391,2.829-1.172l13.39-13.39 l4.283,4.284l-4.496,4.496c-1.562,1.562-1.562,4.094,0,5.656l7.371,7.371l-24.255,24.256l-2.924-2.924 c-0.807-0.807-1.921-1.242-3.058-1.165l-16.651,0.956c-0.98,0.056-1.905,0.471-2.599,1.165l-67.491,67.49 c-0.694,0.693-1.108,1.619-1.165,2.599l-0.955,16.651c-0.065,1.139,0.359,2.251,1.165,3.058l3.45,3.45l-19.049,19.05 c-1.109,1.109-1.559,2.766-1.017,4.238c1.356,3.677,0.447,7.841-2.309,10.599c-2.689,2.688-6.617,3.621-10.247,2.434 c-1.836-0.602-3.836,0.196-4.758,1.893l-9.231,16.997c-0.846,1.557-0.566,3.485,0.687,4.737l2.406,2.406l-6.374,6.374 c-1.562,1.562-1.562,4.095,0,5.657h0c1.562,1.562,4.094,1.562,5.656,0l6.374-6.374l3.45,3.45c0.781,0.781,1.805,1.172,2.829,1.172 s2.047-0.391,2.829-1.172l50.107-50.107l3.415,3.415c0.785,0.785,1.856,1.233,2.966,1.205c0.042-0.001,0.084-0.003,0.126-0.006 l16.651-0.955c0.98-0.056,1.905-0.471,2.599-1.165l67.491-67.491c0.694-0.693,1.108-1.619,1.165-2.599l0.956-16.651 c0.065-1.139-0.359-2.251-1.165-3.058l-2.924-2.924l24.255-24.256l7.371,7.371c0.75,0.75,1.768,1.172,2.829,1.172 s2.078-0.422,2.829-1.172l14.649-14.649c1.562-1.562,1.562-4.094,0-5.656l-15.745-15.745l1.668-1.668l134.769,134.77 c0.75,0.75,1.768,1.172,2.829,1.172s2.078-0.422,2.829-1.172l116.67-116.671C460.21,217.736,460.21,215.203,458.648,213.641z M441.144,68.197l1.993,11.811l-20.565,3.471l-1.994-11.811L441.144,68.197z M142.17,192.24l-7.162-7.161l26.781-26.78l7.162,7.161 L142.17,192.24z M19.48,387.652l-6.572-6.571l6.367-11.725c5.498,0.717,11.05-1.117,15.069-5.136 c4.31-4.311,6.108-10.527,4.902-16.412l17.471-17.471l10.039,10.038L19.48,387.652z M158.929,276.455l-65.335,65.336l-13.34,0.766 l-25.716-25.717l0.765-13.34l65.336-65.335l13.339-0.766l25.716,25.716L158.929,276.455z M158.039,250.145l-11.09-11.09 l24.255-24.256l11.09,11.09L158.039,250.145z M198.151,230.432l-31.489-31.489l8.993-8.992l31.489,31.489L198.151,230.432z M379.124,79.085c1.672-1.672,3.869-2.508,6.065-2.508s4.394,0.836,6.065,2.508c3.345,3.345,3.345,8.787,0,12.132 c-3.344,3.344-8.787,3.344-12.131,0C375.78,87.872,375.78,82.429,379.124,79.085z M385.015,122.183 c2.196-8.264,2.797-15.136,1.819-20.546c2.994-0.296,5.914-1.415,8.417-3.332c13.03,17.688,7.368,44.149,3.895,55.834 l-18.637-18.637C381.672,132.664,383.532,127.767,385.015,122.183z M406.737,215.948l-68.112,68.112l-37.768-37.768l68.112-68.112 L406.737,215.948z M322.4,279.149l-4.282,4.282L301.487,266.8l4.282-4.282L322.4,279.149z M328.056,284.805l7.74,7.74 c0.75,0.75,1.768,1.172,2.829,1.172s2.078-0.422,2.829-1.172l73.769-73.77c1.562-1.562,1.562-4.095,0-5.656l-7.74-7.74l4.282-4.282 l12.757,12.757l-87.991,87.99l-12.757-12.757L328.056,284.805z M401.826,199.723l-16.631-16.631l4.283-4.282l16.631,16.631 L401.826,199.723z M379.538,177.435l-7.74-7.74c-0.75-0.75-1.768-1.172-2.829-1.172s-2.078,0.422-2.829,1.172l-73.769,73.77 c-1.562,1.562-1.562,4.095,0,5.656l7.74,7.74l-4.282,4.282l-29.083-29.083l4.282-4.282l7.74,7.74c0.75,0.75,1.768,1.172,2.829,1.172 s2.078-0.422,2.829-1.172l73.77-73.77c0.75-0.75,1.171-1.768,1.171-2.828s-0.421-2.078-1.171-2.828l-7.74-7.74l4.282-4.282 l29.083,29.083L379.538,177.435z M349.71,158.92l-68.113,68.112l-37.768-37.768l68.112-68.111L349.71,158.92z M265.372,222.122 l-4.282,4.282l-16.631-16.631l4.282-4.282L265.372,222.122z M344.798,142.695l-16.631-16.63l4.283-4.283l16.631,16.631 L344.798,142.695z M322.511,120.408l-7.74-7.74c-1.563-1.563-4.095-1.562-5.657,0l-73.769,73.769c-1.562,1.562-1.562,4.095,0,5.656 l7.74,7.74l-4.282,4.282l-20.084-20.084l87.991-87.991l20.084,20.084L322.511,120.408z M339.149,327.483l-131.941-131.94 l5.854-5.854l120.64,120.641c0.75,0.75,1.768,1.172,2.829,1.172s2.078-0.422,2.829-1.172l93.647-93.647 c1.562-1.562,1.562-4.095,0-5.656L312.366,90.385l5.856-5.856l131.941,131.94L339.149,327.483z"/> </g>
					</svg>`
        };
        return icons[serviceType] || '<circle cx="12" cy="12" r="10"/>';
    }

    render() {
        const categoriesHTML = Object.entries(this.servicesData).map(([serviceType, subserviceIds]) => {
            const subservicesHTML = subserviceIds.map(subId => 
                `<li data-service="${subId}">${subId}</li>`
            ).join('');

            return `
                <li class="service-category">
                    <div class="category-row">
                        ${this.getSVGIcon(serviceType)}
                        <p class="category-name">${serviceType}</p>
                    </div>
                    <ul class="subservice">
                        ${subservicesHTML}
                    </ul>
                </li>
            `;
        }).join('');

        this.innerHTML = `
            <ul class="service">
                ${categoriesHTML}
            </ul>`;
    }

    setupEventListeners() {
        const orderInner = this.closest('order-inner');
        if (!orderInner) return;

        const btn = orderInner.querySelector('.toggle-btn');
        const btnText = btn?.querySelector('p');
        const contentDiv = orderInner.querySelector('.hidden-content');

        const categories = this.querySelectorAll('.service-category');
        categories.forEach(category => {
            const categoryRow = category.querySelector('.category-row');
            const categoryName = category.querySelector('.category-name');
            const subList = category.querySelector('.subservice');

            categoryRow.addEventListener('click', (e) => {
                e.stopPropagation();
                
                categories.forEach(otherCategory => {
                    if (otherCategory !== category) {
                        otherCategory.querySelector('.subservice')?.classList.remove('show');
                    }
                });
                
                subList.classList.toggle('show');
            });

            const subItems = subList.querySelectorAll('li');
            subItems.forEach(subItem => {
                subItem.addEventListener('click', (e) => {
                    e.stopPropagation();
                    
                    const selectedSubService = subItem.textContent;
                    const serviceId = subItem.dataset.service;
                    
                    if (btnText) {
                        btnText.textContent = selectedSubService;
                    }
                    
                    if (window.orderManager) {
                        window.orderManager.updateService(serviceId);
                    }
                    
                    subList.classList.remove('show');
                    if (contentDiv) {
                        contentDiv.classList.remove('show');
                    }
                });
            });
        });
    }
}

window.customElements.define('order-service', OrderService);